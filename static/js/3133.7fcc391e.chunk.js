"use strict";(self.webpackChunkapp_frontend=self.webpackChunkapp_frontend||[]).push([[3133],{16171:function(e,t,n){var r={selectLoading:(0,n(76747).P1)([function(e){return e.election.destroy}],(function(e){return Boolean(e.loading)}))};t.Z=r},4513:function(e,t,n){var r=n(76747),a=n(86495),i=n(26319),s=n(71945),o=(0,r.P1)([a.Z.selectCurrentTenant,a.Z.selectCurrentUser],(function(e,t){return new i.Z(e,t).match(s.Z.values.electionRead)})),l=(0,r.P1)([a.Z.selectCurrentTenant,a.Z.selectCurrentUser],(function(e,t){return new i.Z(e,t).match(s.Z.values.electionEdit)})),c=(0,r.P1)([a.Z.selectCurrentTenant,a.Z.selectCurrentUser],(function(e,t){return new i.Z(e,t).match(s.Z.values.electionCreate)})),u=(0,r.P1)([a.Z.selectCurrentTenant,a.Z.selectCurrentUser],(function(e,t){return new i.Z(e,t).match(s.Z.values.electionImport)})),d={selectPermissionToRead:o,selectPermissionToEdit:l,selectPermissionToCreate:c,selectPermissionToDestroy:(0,r.P1)([a.Z.selectCurrentTenant,a.Z.selectCurrentUser],(function(e,t){return new i.Z(e,t).match(s.Z.values.electionDestroy)})),selectPermissionToImport:u};t.Z=d},6891:function(e,t,n){n.d(t,{Z:function(){return Z}});var r=n(70885),a=n(15861),i=n(15671),s=n(43144),o=n(87757),l=n.n(o),c=n(99811),u=n.n(c),d=n(10499),f=n(63922),m=n(71351),v=n(81384),p=n(31881),b=n.n(p),Z=function(){function e(){(0,i.Z)(this,e)}return(0,s.Z)(e,null,[{key:"validate",value:function(e,t){if(t){if(t.image&&!e.type.startsWith("image"))throw new Error((0,d.ag)("fileUploader.image"));if(t.storage.maxSizeInBytes&&e.size>t.storage.maxSizeInBytes)throw new Error((0,d.ag)("fileUploader.size",u()(t.storage.maxSizeInBytes)));var n=h(e.name);if(t.formats&&!t.formats.includes(n))throw new Error((0,d.ag)("fileUploader.formats",t.formats.join(", ")))}}},{key:"upload",value:function(){var e=(0,a.Z)(l().mark((function e(t,n){var r,a,i,s,o,c,u;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,this.validate(t,n),e.next=7;break;case 4:return e.prev=4,e.t0=e.catch(0),e.abrupt("return",Promise.reject(e.t0));case 7:return r=h(t.name),a=(0,m.Z)(),i="".concat(a,".").concat(r),e.next=12,this.fetchFileCredentials(i,n);case 12:return s=e.sent,o=s.uploadCredentials,c=s.downloadUrl,u=s.privateUrl,e.next=18,this.uploadToServer(t,o);case 18:return e.abrupt("return",{id:a,name:t.name,sizeInBytes:t.size,publicUrl:o&&o.publicUrl?o.publicUrl:null,privateUrl:u,downloadUrl:c,new:!0});case 19:case"end":return e.stop()}}),e,this,[[0,4]])})));return function(t,n){return e.apply(this,arguments)}}()},{key:"fetchFileCredentials",value:function(){var e=(0,a.Z)(l().mark((function e(t,n){var r,a,i;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=v.Z.get(),e.next=3,f.Z.get("/tenant/".concat(r,"/file/credentials"),{params:{filename:t,storageId:n.storage.id}});case 3:return a=e.sent,i=a.data,e.abrupt("return",i);case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"uploadToServer",value:function(){var e=(0,a.Z)(l().mark((function e(t,n){var a,i,s,o,c,u,d;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(e.prev=0,a=n.url,i=new FormData,s=0,o=Object.entries(n.fields||{});s<o.length;s++)c=(0,r.Z)(o[s],2),u=c[0],d=c[1],i.append(u,d);return i.append("file",t),e.abrupt("return",b().post(a,i,{headers:{"Content-Type":"multipart/form-data"}}));case 8:throw e.prev=8,e.t0=e.catch(0),console.error(e.t0),e.t0;case 12:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t,n){return e.apply(this,arguments)}}()}]),e}();function h(e){if(!e)return null;var t=/(?:\.([^.]+))?$/.exec(e);return t?t[1]:null}},15021:function(e,t,n){var r=n(76747),a=n(86495),i=n(26319),s=n(71945),o=(0,r.P1)([a.Z.selectCurrentTenant,a.Z.selectCurrentUser],(function(e,t){return new i.Z(e,t).match(s.Z.values.userRead)})),l=(0,r.P1)([a.Z.selectCurrentTenant,a.Z.selectCurrentUser],(function(e,t){return new i.Z(e,t).match(s.Z.values.userEdit)})),c=(0,r.P1)([a.Z.selectCurrentTenant,a.Z.selectCurrentUser],(function(e,t){return new i.Z(e,t).match(s.Z.values.userDestroy)})),u={selectPermissionToRead:o,selectPermissionToEdit:l,selectPermissionToCreate:(0,r.P1)([a.Z.selectCurrentTenant,a.Z.selectCurrentUser],(function(e,t){return new i.Z(e,t).match(s.Z.values.userCreate)})),selectPermissionToImport:(0,r.P1)([a.Z.selectCurrentTenant,a.Z.selectCurrentUser],(function(e,t){return new i.Z(e,t).match(s.Z.values.userImport)})),selectPermissionToDestroy:c};t.Z=u},93133:function(e,t,n){n.r(t),n.d(t,{default:function(){return z}});var r=n(47313),a=n(45788),i=n(63830),s=n(10499),o=n(57550),l=n(76747),c=function(e){return e.election.view},u=(0,l.P1)([c],(function(e){return e.record})),d={selectLoading:(0,l.P1)([c],(function(e){return Boolean(e.loading)})),selectRecord:u,selectRaw:c},f=n(61567),m=n(25969),v=n(31287),p=n(6260),b=n(86193),Z=n(46417);var h=function(e){var t=e.record;return e.loading||!t?(0,Z.jsx)(f.Z,{}):(0,Z.jsxs)(m.Z,{children:[(0,Z.jsx)(v.Z,{label:(0,s.ag)("entities.election.fields.name"),value:t.name}),(0,Z.jsx)(p.Z,{label:(0,s.ag)("entities.election.fields.members"),value:t.members}),(0,Z.jsx)(v.Z,{label:(0,s.ag)("entities.election.fields.startDate"),value:t.startDate}),(0,Z.jsx)(v.Z,{label:(0,s.ag)("entities.election.fields.endDate"),value:t.endDate}),(0,Z.jsx)(b.Z,{label:(0,s.ag)("entities.election.fields.pv"),value:t.pv})]})},x=n(70885),g=n(28303),j=n(23516),y=n(4513),w=n(93590),C=n(16171),T=n(44587),P=n(10419),B=n(95748);var k=function(e){var t=(0,r.useState)(!1),n=(0,x.Z)(t,2),i=n[0],o=n[1],l=(0,a.I0)(),c=e.match.params.id,u=(0,a.v9)(j.Z.selectPermissionToRead),d=(0,a.v9)(y.Z.selectPermissionToEdit),f=(0,a.v9)(y.Z.selectPermissionToDestroy),m=(0,a.v9)(C.Z.selectLoading),v=function(){o(!1)};return(0,Z.jsxs)(P.Z,{children:[d&&(0,Z.jsx)(g.rU,{to:"/election/".concat(c,"/edit"),children:(0,Z.jsxs)("button",{className:"btn btn-primary",type:"button",children:[(0,Z.jsx)(B.Z,{iconClass:"fas fa-edit"})," ",(0,s.ag)("common.edit")]})}),f&&(0,Z.jsxs)("button",{className:"btn btn-primary",type:"button",disabled:m,onClick:function(){o(!0)},children:[(0,Z.jsx)(B.Z,{loading:m,iconClass:"fas fa-trash-alt"})," ",(0,s.ag)("common.destroy")]}),u&&(0,Z.jsx)(g.rU,{to:"/audit-logs?entityId=".concat(encodeURIComponent(c)),children:(0,Z.jsxs)("button",{className:"btn btn-light",type:"button",children:[(0,Z.jsx)(B.Z,{iconClass:"fas fa-history"})," ",(0,s.ag)("auditLog.menu")]})}),i&&(0,Z.jsx)(T.Z,{title:(0,s.ag)("common.areYouSure"),onConfirm:function(){return v(),void l(w.Z.doDestroy(c))},onClose:function(){return v()},okText:(0,s.ag)("common.yes"),cancelText:(0,s.ag)("common.no")})]})},U=n(27829),N=n(53852),I=n(75352),E=n(66620),D=n(65487),M=n(75124),R=n(32358),S=n(91334);var z=function(){var e=(0,a.I0)(),t=(0,i.$B)(),n=(0,a.v9)(d.selectLoading),l=(0,a.v9)(d.selectRecord);return(0,r.useEffect)((function(){e(o.Z.doFind(t.params.id))}),[e,t.params.id]),(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)(N.Z,{items:[[(0,s.ag)("dashboard.menu"),"/"],[(0,s.ag)("entities.election.menu"),"/election"],[(0,s.ag)("entities.election.view.title")]]}),(0,Z.jsxs)(U.Z,{children:[(0,Z.jsx)(I.Z,{children:(0,s.ag)("entities.election.view.title")}),(0,Z.jsx)(k,{match:t}),(0,Z.jsxs)(E.Z,{defaultActiveKey:"informations",id:"tab-inf-user",children:[(0,Z.jsx)(D.Z,{eventKey:"informations",title:"Informations",children:(0,Z.jsx)(h,{loading:n,record:l})}),(0,Z.jsxs)(D.Z,{eventKey:"Objectifs",title:"Objectifs",children:[(0,Z.jsx)("br",{}),(0,Z.jsx)("br",{}),(0,Z.jsx)(S.Z,{electionId:t.params.id}),(0,Z.jsx)("br",{}),(0,Z.jsx)(M.Z,{electionId:t.params.id,record:l}),(0,Z.jsx)(R.Z,{})]})]})]})]})}},25969:function(e,t,n){var r,a=n(30168),i=n(91876).ZP.div(r||(r=(0,a.Z)(["\n  .btn.btn-link {\n    padding-left: 0;\n  }\n"])));t.Z=i},10619:function(e,t,n){var r=n(42982),a=n(15861),i=n(70885),s=n(87757),o=n.n(s),l=n(47313),c=n(6891),u=n(33512),d=n(10499),f=n(95748),m=n(46417);t.Z=function(e){var t=(0,l.useState)(!1),n=(0,i.Z)(t,2),s=n[0],v=n[1],p=(0,l.useRef)(),b=function(){var t=e.value;return t?Array.isArray(t)?t:[t]:[]},Z=function(){var t=(0,a.Z)(o().mark((function t(n){var a,i;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,(a=n.target.files)&&a.length){t.next=4;break}return t.abrupt("return");case 4:return i=a[0],c.Z.validate(i,{storage:e.storage,formats:e.formats}),v(!0),t.next=9,c.Z.upload(i,{storage:e.storage,formats:e.formats});case 9:i=t.sent,p.current.value="",v(!1),e.onChange([].concat((0,r.Z)(b()),[i])),t.next=21;break;case 15:t.prev=15,t.t0=t.catch(0),p.current.value="",console.error(t.t0),v(!1),u.Z.showMessage(t.t0);case 21:case"end":return t.stop()}}),t,null,[[0,15]])})));return function(e){return t.apply(this,arguments)}}(),h=e.max,x=e.readonly,g=(0,m.jsxs)("label",{className:"btn btn-outline-secondary px-4 mb-2",style:{cursor:"pointer"},children:[(0,m.jsx)(f.Z,{loading:s,iconClass:"fas fa-plus"}),(0,d.ag)("fileUploader.upload"),(0,m.jsx)("input",{style:{display:"none"},disabled:s||x,accept:function(){var t=e.schema;if(t&&t.formats)return t.formats.map((function(e){return".".concat(e)})).join(",")}(),type:"file",onChange:Z,ref:p})]});return(0,m.jsxs)("div",{children:[x||h&&b().map((function(e){return{uid:e.id||void 0,name:e.name,status:"done",url:e.downloadUrl}})).length>=h?null:g,b()&&b().length?(0,m.jsx)("div",{children:b().map((function(t){return(0,m.jsxs)("div",{children:[(0,m.jsx)("i",{className:"fas fa-link text-muted mr-2"}),(0,m.jsx)("a",{href:t.downloadUrl,target:"_blank",rel:"noopener noreferrer",download:!0,children:t.name}),!x&&(0,m.jsx)("button",{className:"btn btn-link",type:"button",onClick:function(){return n=t.id,void e.onChange(b().filter((function(e){return e.id!==n})));var n},children:(0,m.jsx)("i",{className:"fas fa-times"})})]},t.id)}))}):null]})}},86193:function(e,t,n){n(47313);var r=n(10619),a=n(46417);t.Z=function(e){var t=function(){var t=e.value;return t?Array.isArray(t)?t:[t]:[]};return t().length?(0,a.jsxs)("div",{className:"form-group",children:[(0,a.jsx)("label",{className:"col-form-label",children:e.label}),(0,a.jsx)("br",{}),(0,a.jsx)(r.Z,{readonly:!0,value:t()})]}):null}},31287:function(e,t,n){n(47313);var r=n(46417);t.Z=function(e){if(!e.value&&0!==e.value&&!1!==e.value)return null;var t="".concat(e.prefix?"".concat(e.prefix," "):"").concat(e.value);return(0,r.jsxs)("div",{className:"form-group",children:[(0,r.jsx)("label",{className:"col-form-label",children:e.label}),(0,r.jsx)("input",{type:"text",readOnly:!0,className:"form-control-plaintext",value:t})]})}},6260:function(e,t,n){var r=n(15021),a=(n(47313),n(45788)),i=n(28303),s=n(46417);t.Z=function(e){var t=(0,a.v9)(r.Z.selectPermissionToRead),n=function(){var t=e.value;return t?Array.isArray(t)?t:[t]:[]},o=function(e){return e?e.fullName?"".concat(e.fullName," <").concat(e.email,">"):e.email:null};return n().length?(0,s.jsxs)("div",{style:{marginBottom:"16px"},children:[(0,s.jsx)("label",{className:"col-form-label",children:e.label}),n().map((function(e){return n=e,t?(0,s.jsx)("div",{children:(0,s.jsx)(i.rU,{className:"btn btn-link",to:"/user/".concat(n.id),children:o(n)})},n.id):(0,s.jsx)("div",{children:o(n)},n.id);var n}))]}):null}},99811:function(e,t,n){!function(t){var n=/^(b|B)$/,r={iec:{bits:["b","Kib","Mib","Gib","Tib","Pib","Eib","Zib","Yib"],bytes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"]},jedec:{bits:["b","Kb","Mb","Gb","Tb","Pb","Eb","Zb","Yb"],bytes:["B","KB","MB","GB","TB","PB","EB","ZB","YB"]}},a={iec:["","kibi","mebi","gibi","tebi","pebi","exbi","zebi","yobi"],jedec:["","kilo","mega","giga","tera","peta","exa","zetta","yotta"]};function i(e){var t,i,s,o,l,c,u,d,f,m,v,p,b,Z,h,x=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},g=[],j=0,y=void 0,w=void 0;if(isNaN(e))throw new TypeError("Invalid number");return i=!0===x.bits,v=!0===x.unix,t=x.base||2,m=void 0!==x.round?x.round:v?1:2,c=void 0!==x.locale?x.locale:"",u=x.localeOptions||{},p=void 0!==x.separator?x.separator:"",b=void 0!==x.spacer?x.spacer:v?"":" ",h=x.symbols||{},Z=2===t&&x.standard||"jedec",f=x.output||"string",o=!0===x.fullform,l=x.fullforms instanceof Array?x.fullforms:[],y=void 0!==x.exponent?x.exponent:-1,s=2<t?1e3:1024,(d=(w=Number(e))<0)&&(w=-w),(-1===y||isNaN(y))&&(y=Math.floor(Math.log(w)/Math.log(s)))<0&&(y=0),8<y&&(y=8),"exponent"===f?y:(0===w?(g[0]=0,g[1]=v?"":r[Z][i?"bits":"bytes"][y]):(j=w/(2===t?Math.pow(2,10*y):Math.pow(1e3,y)),i&&s<=(j*=8)&&y<8&&(j/=s,y++),g[0]=Number(j.toFixed(0<y?m:0)),g[0]===s&&y<8&&void 0===x.exponent&&(g[0]=1,y++),g[1]=10===t&&1===y?i?"kb":"kB":r[Z][i?"bits":"bytes"][y],v&&(g[1]="jedec"===Z?g[1].charAt(0):0<y?g[1].replace(/B$/,""):g[1],n.test(g[1])&&(g[0]=Math.floor(g[0]),g[1]=""))),d&&(g[0]=-g[0]),g[1]=h[g[1]]||g[1],!0===c?g[0]=g[0].toLocaleString():0<c.length?g[0]=g[0].toLocaleString(c,u):0<p.length&&(g[0]=g[0].toString().replace(".",p)),"array"===f?g:(o&&(g[1]=l[y]?l[y]:a[Z][y]+(i?"bit":"byte")+(1===g[0]?"":"s")),"object"===f?{value:g[0],symbol:g[1],exponent:y}:g.join(b)))}i.partial=function(e){return function(t){return i(t,e)}},e.exports=i}("undefined"!=typeof window?window:n.g)}}]);