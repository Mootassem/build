(self.webpackChunkapp_frontend=self.webpackChunkapp_frontend||[]).push([[6772],{3151:function(e,n,t){"use strict";var r=t(76747),a=t(86495),s=t(26319),o=t(71945),i=(0,r.P1)([a.Z.selectCurrentTenant,a.Z.selectCurrentUser],(function(e,n){return new s.Z(e,n).match(o.Z.values.campaignRead)})),l=(0,r.P1)([a.Z.selectCurrentTenant,a.Z.selectCurrentUser],(function(e,n){return new s.Z(e,n).match(o.Z.values.campaignEdit)})),c=(0,r.P1)([a.Z.selectCurrentTenant,a.Z.selectCurrentUser],(function(e,n){return new s.Z(e,n).match(o.Z.values.campaignCreate)})),u=(0,r.P1)([a.Z.selectCurrentTenant,a.Z.selectCurrentUser],(function(e,n){return new s.Z(e,n).match(o.Z.values.campaignImport)})),d={selectPermissionToRead:i,selectPermissionToEdit:l,selectPermissionToCreate:c,selectPermissionToDestroy:(0,r.P1)([a.Z.selectCurrentTenant,a.Z.selectCurrentUser],(function(e,n){return new s.Z(e,n).match(o.Z.values.campaignDestroy)})),selectPermissionToImport:u};n.Z=d},31978:function(e,n,t){"use strict";var r=t(76747),a=t(86495),s=t(26319),o=t(71945),i=(0,r.P1)([a.Z.selectCurrentTenant,a.Z.selectCurrentUser],(function(e,n){return new s.Z(e,n).match(o.Z.values.formuleRead)})),l=(0,r.P1)([a.Z.selectCurrentTenant,a.Z.selectCurrentUser],(function(e,n){return new s.Z(e,n).match(o.Z.values.formuleEdit)})),c=(0,r.P1)([a.Z.selectCurrentTenant,a.Z.selectCurrentUser],(function(e,n){return new s.Z(e,n).match(o.Z.values.formuleCreate)})),u=(0,r.P1)([a.Z.selectCurrentTenant,a.Z.selectCurrentUser],(function(e,n){return new s.Z(e,n).match(o.Z.values.formuleImport)})),d={selectPermissionToRead:i,selectPermissionToEdit:l,selectPermissionToCreate:c,selectPermissionToDestroy:(0,r.P1)([a.Z.selectCurrentTenant,a.Z.selectCurrentUser],(function(e,n){return new s.Z(e,n).match(o.Z.values.formuleDestroy)})),selectPermissionToImport:u};n.Z=d},6891:function(e,n,t){"use strict";t.d(n,{Z:function(){return b}});var r=t(70885),a=t(15861),s=t(15671),o=t(43144),i=t(87757),l=t.n(i),c=t(99811),u=t.n(c),d=t(10499),m=t(63922),f=t(71351),h=t(81384),p=t(31881),v=t.n(p),b=function(){function e(){(0,s.Z)(this,e)}return(0,o.Z)(e,null,[{key:"validate",value:function(e,n){if(n){if(n.image&&!e.type.startsWith("image"))throw new Error((0,d.ag)("fileUploader.image"));if(n.storage.maxSizeInBytes&&e.size>n.storage.maxSizeInBytes)throw new Error((0,d.ag)("fileUploader.size",u()(n.storage.maxSizeInBytes)));var t=g(e.name);if(n.formats&&!n.formats.includes(t))throw new Error((0,d.ag)("fileUploader.formats",n.formats.join(", ")))}}},{key:"upload",value:function(){var e=(0,a.Z)(l().mark((function e(n,t){var r,a,s,o,i,c,u;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,this.validate(n,t),e.next=7;break;case 4:return e.prev=4,e.t0=e.catch(0),e.abrupt("return",Promise.reject(e.t0));case 7:return r=g(n.name),a=(0,f.Z)(),s="".concat(a,".").concat(r),e.next=12,this.fetchFileCredentials(s,t);case 12:return o=e.sent,i=o.uploadCredentials,c=o.downloadUrl,u=o.privateUrl,e.next=18,this.uploadToServer(n,i);case 18:return e.abrupt("return",{id:a,name:n.name,sizeInBytes:n.size,publicUrl:i&&i.publicUrl?i.publicUrl:null,privateUrl:u,downloadUrl:c,new:!0});case 19:case"end":return e.stop()}}),e,this,[[0,4]])})));return function(n,t){return e.apply(this,arguments)}}()},{key:"fetchFileCredentials",value:function(){var e=(0,a.Z)(l().mark((function e(n,t){var r,a,s;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=h.Z.get(),e.next=3,m.Z.get("/tenant/".concat(r,"/file/credentials"),{params:{filename:n,storageId:t.storage.id}});case 3:return a=e.sent,s=a.data,e.abrupt("return",s);case 6:case"end":return e.stop()}}),e)})));return function(n,t){return e.apply(this,arguments)}}()},{key:"uploadToServer",value:function(){var e=(0,a.Z)(l().mark((function e(n,t){var a,s,o,i,c,u,d;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(e.prev=0,a=t.url,s=new FormData,o=0,i=Object.entries(t.fields||{});o<i.length;o++)c=(0,r.Z)(i[o],2),u=c[0],d=c[1],s.append(u,d);return s.append("file",n),e.abrupt("return",v().post(a,s,{headers:{"Content-Type":"multipart/form-data"}}));case 8:throw e.prev=8,e.t0=e.catch(0),console.error(e.t0),e.t0;case 12:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(n,t){return e.apply(this,arguments)}}()}]),e}();function g(e){if(!e)return null;var n=/(?:\.([^.]+))?$/.exec(e);return n?n[1]:null}},39916:function(e,n,t){"use strict";var r=t(1413),a=t(70885),s=t(47313),o=t(43270),i=t(10499),l=t(89994),c=t(95748),u=t(68160),d=t(42277),m=t(67357),f=t(47575),h=t(30513),p=t(66620),v=t(65487),b=t(22102),g=t(63849),x=t(31616),Z=t(46417),j=d.Ry().shape({name:l.Z.string((0,i.ag)("entities.formule.fields.name"),{}),description:l.Z.string((0,i.ag)("entities.formule.fields.description"),{}),amount:l.Z.decimal((0,i.ag)("entities.formule.fields.amount"),{})});n.Z=function(e){var n=(0,s.useState)((function(){var n=e.record||{};return{name:n.name,description:n.description,amount:n.amount}})),t=(0,a.Z)(n,1)[0],l=(0,o.cI)({resolver:(0,m.X)(j),mode:"all",defaultValues:t}),d=function(n){var t,a=(0,r.Z)({membership:e.record.membership},n);e.onSubmit(null===(t=e.record)||void 0===t?void 0:t.id,a)};return(0,Z.jsx)(u.Z,{children:(0,Z.jsx)(o.RV,(0,r.Z)((0,r.Z)({},l),{},{children:(0,Z.jsxs)("form",{onSubmit:l.handleSubmit(d),children:[(0,Z.jsx)(p.Z,{defaultActiveKey:"information",id:"0",className:"mb-3",children:(0,Z.jsx)(v.Z,{eventKey:"information",title:"Information",children:(0,Z.jsx)(b.Z,{fluid:!0,children:(0,Z.jsxs)(g.Z,{children:[(0,Z.jsx)(x.Z,{children:(0,Z.jsx)(f.Z,{name:"name",label:(0,i.ag)("entities.formule.fields.name"),required:!1,autoFocus:!0})}),(0,Z.jsx)(x.Z,{xs:6,children:(0,Z.jsx)(h.Z,{name:"description",label:(0,i.ag)("entities.formule.fields.description"),required:!1})}),(0,Z.jsx)(x.Z,{children:(0,Z.jsx)(f.Z,{name:"amount",label:(0,i.ag)("entities.formule.fields.amount"),required:!1})})]})})})}),(0,Z.jsxs)("div",{className:"form-buttons",children:[(0,Z.jsxs)("button",{className:"btn btn-primary",disabled:e.saveLoading,type:"button",onClick:l.handleSubmit(d),children:[(0,Z.jsx)(c.Z,{loading:e.saveLoading,iconClass:"far fa-save"}),(0,i.ag)("common.save")]}),(0,Z.jsxs)("button",{className:"btn btn-light",type:"button",disabled:e.saveLoading,onClick:function(){Object.keys(t).forEach((function(e){l.setValue(e,t[e])}))},children:[(0,Z.jsx)("i",{className:"fas fa-undo"}),(0,i.ag)("common.reset")]}),e.onCancel?(0,Z.jsxs)("button",{className:"btn btn-light",type:"button",disabled:e.saveLoading,onClick:function(){return e.onCancel()},children:[(0,Z.jsx)("i",{className:"fas fa-times"}),(0,i.ag)("common.cancel")]}):null]})]})}))})}},97173:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return H}});var r=t(70885),a=t(47313),s=t(45788),o=t(63830),i=t(10499),l=t(87226),c=t(76747),u=function(e){return e.membership.form},d=(0,c.P1)([u],(function(e){return e.record})),m={selectInitLoading:(0,c.P1)([u],(function(e){return Boolean(e.initLoading)})),selectSaveLoading:(0,c.P1)([u],(function(e){return Boolean(e.saveLoading)})),selectRecord:d,selectRaw:u},f=t(59436),h=t(1413),p=t(43270),v=t(89994),b=t(95748),g=t(68160),x=t(42277),Z=t(67357),j=t(47575),y=t(48317),w=t(5544),C=t(94307),N=t(96111),k=t(87347),B=t(42982),S=t(16696),P=t(15861),T=t(87757),I=t.n(T),M=t(1168),U=t(33512),E=t(39916),L=t(46417);var V=function(e){var n=(0,a.useRef)(),t=(0,a.useState)(!1),s=(0,r.Z)(t,2),o=s[0],l=s[1];(0,a.useEffect)((function(){window.$(n.current).modal("show"),window.$(n.current).on("hidden.bs.modal",e.onClose)}),[]);var c=function(){var t=(0,P.Z)(I().mark((function t(r,a){var s,o,i;return I().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,l(!0),t.next=4,S.Z.create(a);case 4:return s=t.sent,o=s.id,t.next=8,S.Z.find(o);case 8:i=t.sent,window.$(n.current).modal("hide"),e.onSuccess(i),t.next=16;break;case 13:t.prev=13,t.t0=t.catch(0),U.Z.handle(t.t0);case 16:return t.prev=16,l(!1),t.finish(16);case 19:case"end":return t.stop()}}),t,null,[[0,13,16,19]])})));return function(e,n){return t.apply(this,arguments)}}();return M.createPortal((0,L.jsx)("div",{ref:n,className:"modal",tabIndex:-1,children:(0,L.jsx)("div",{className:"modal-dialog modal-lg",children:(0,L.jsxs)("div",{className:"modal-content",children:[(0,L.jsxs)("div",{className:"modal-header",children:[(0,L.jsx)("h5",{className:"modal-title",children:(0,i.ag)("entities.formule.new.title")}),(0,L.jsx)("button",{type:"button",className:"close","data-dismiss":"modal",children:(0,L.jsx)("span",{children:"\xd7"})})]}),(0,L.jsx)("div",{className:"modal-body",children:(0,L.jsx)(E.Z,{saveLoading:o,onSubmit:c,onCancel:function(){window.$(n.current).modal("hide")},modal:!0})})]})})}),document.getElementById("modal-root"))},q=t(49513),F=t(31978);var R=function(e){var n=(0,p.Gc)(),t=n.setValue,o=n.getValues,i=(0,a.useState)(!1),l=(0,r.Z)(i,2),c=l[0],u=l[1],d=(0,s.v9)(F.Z.selectPermissionToCreate),m=function(){u(!1)};return(0,L.jsxs)(L.Fragment,{children:[(0,L.jsx)(q.Z,(0,h.Z)((0,h.Z)({},e),{},{fetchFn:function(e,n){return S.Z.listAutocomplete(e,n)},mapper:{toAutocomplete:function(e){if(!e)return null;var n=e.id,t=e.label;return e.name&&(t=e.name),{key:n,value:n,label:t}},toValue:function(e){return e?{id:e.value,label:e.label}:null}},onOpenModal:function(){u(!0)},hasPermissionToCreate:d})),c&&(0,L.jsx)(V,{onClose:m,onSuccess:function(n){var r=e.name,a=e.mode;t(r,a&&"multiple"===a?[].concat((0,B.Z)(o()[r]||[]),[n]):n,{shouldValidate:!0,shouldDirty:!0}),m()}})]})},A=t(3510),$=t(7911);var z=function(e){var n=(0,a.useRef)(),t=(0,a.useState)(!1),s=(0,r.Z)(t,2),o=s[0],l=s[1];(0,a.useEffect)((function(){window.$(n.current).modal("show"),window.$(n.current).on("hidden.bs.modal",e.onClose)}),[]);var c=function(){var t=(0,P.Z)(I().mark((function t(r,a){var s,o,i;return I().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,l(!0),t.next=4,A.Z.create(a);case 4:return s=t.sent,o=s.id,t.next=8,A.Z.find(o);case 8:i=t.sent,window.$(n.current).modal("hide"),e.onSuccess(i),t.next=16;break;case 13:t.prev=13,t.t0=t.catch(0),U.Z.handle(t.t0);case 16:return t.prev=16,l(!1),t.finish(16);case 19:case"end":return t.stop()}}),t,null,[[0,13,16,19]])})));return function(e,n){return t.apply(this,arguments)}}();return M.createPortal((0,L.jsx)("div",{ref:n,className:"modal",tabIndex:-1,children:(0,L.jsx)("div",{className:"modal-dialog modal-lg",children:(0,L.jsxs)("div",{className:"modal-content",children:[(0,L.jsxs)("div",{className:"modal-header",children:[(0,L.jsx)("h5",{className:"modal-title",children:(0,i.ag)("entities.campaign.new.title")}),(0,L.jsx)("button",{type:"button",className:"close","data-dismiss":"modal",children:(0,L.jsx)("span",{children:"\xd7"})})]}),(0,L.jsx)("div",{className:"modal-body",children:(0,L.jsx)($.Z,{saveLoading:o,onSubmit:c,onCancel:function(){window.$(n.current).modal("hide")},modal:!0})})]})})}),document.getElementById("modal-root"))},O=t(3151);var G=function(e){var n=(0,p.Gc)(),t=n.setValue,o=n.getValues,i=(0,a.useState)(!1),l=(0,r.Z)(i,2),c=l[0],u=l[1],d=(0,s.v9)(O.Z.selectPermissionToCreate),m=function(){u(!1)};return(0,L.jsxs)(L.Fragment,{children:[(0,L.jsx)(q.Z,(0,h.Z)((0,h.Z)({},e),{},{fetchFn:function(e,n){return A.Z.listAutocomplete(e,n)},mapper:{toAutocomplete:function(e){if(!e)return null;var n=e.id,t=e.label;return e.name&&(t=e.name),{key:n,value:n,label:t}},toValue:function(e){return e?{id:e.value,label:e.label}:null}},onOpenModal:function(){u(!0)},hasPermissionToCreate:d})),c&&(0,L.jsx)(z,{onClose:m,onSuccess:function(n){var r=e.name,a=e.mode;t(r,a&&"multiple"===a?[].concat((0,B.Z)(o()[r]||[]),[n]):n,{shouldValidate:!0,shouldDirty:!0}),m()}})]})},D=x.Ry().shape({status:v.Z.enumerator((0,i.ag)("entities.membership.fields.status"),{options:C.Z.status}),paymentMethod:v.Z.enumerator((0,i.ag)("entities.membership.fields.paymentMethod"),{options:C.Z.paymentMethod}),formule:v.Z.relationToOne((0,i.ag)("entities.membership.fields.formule"),{}),attachements:v.Z.files((0,i.ag)("entities.membership.fields.attachements"),{}),user:v.Z.relationToOne((0,i.ag)("entities.membership.fields.member"),{}),campaign:v.Z.relationToOne((0,i.ag)("entities.membership.fields.campaign"),{}),amount:v.Z.decimal((0,i.ag)("entities.membership.fields.amount"),{})});var K=function(e){var n=(0,a.useState)((function(){var n=e.record||{};return{status:n.status,paymentMethod:n.paymentMethod,formule:n.formule,attachements:n.attachements||[],user:n.user,campaign:n.campaign,amount:n.amount}})),t=(0,r.Z)(n,1)[0],s=(0,p.cI)({resolver:(0,Z.X)(D),mode:"all",defaultValues:t}),o=function(n){var t;e.onSubmit(null===(t=e.record)||void 0===t?void 0:t.id,n)};return(0,L.jsx)(g.Z,{children:(0,L.jsx)(p.RV,(0,h.Z)((0,h.Z)({},s),{},{children:(0,L.jsxs)("form",{onSubmit:s.handleSubmit(o),children:[(0,L.jsxs)("div",{className:"row",children:[(0,L.jsx)("div",{className:"col-lg-7 col-md-8 col-12",children:(0,L.jsx)(w.Z,{name:"status",label:(0,i.ag)("entities.membership.fields.status"),options:C.Z.status.map((function(e){return{value:e,label:(0,i.ag)("entities.membership.enumerators.status.".concat(e))}})),required:!1})}),(0,L.jsx)("div",{className:"col-lg-7 col-md-8 col-12",children:(0,L.jsx)(w.Z,{name:"paymentMethod",label:(0,i.ag)("entities.membership.fields.paymentMethod"),options:C.Z.paymentMethod.map((function(e){return{value:e,label:(0,i.ag)("entities.membership.enumerators.paymentMethod.".concat(e))}})),required:!1})}),(0,L.jsx)("div",{className:"col-lg-7 col-md-8 col-12",style:{display:e.formuleId?"none":"block"},children:(0,L.jsx)(R,{name:"formule",label:(0,i.ag)("entities.membership.fields.formule"),required:!1,showCreate:!e.modal})}),(0,L.jsx)("div",{className:"col-lg-7 col-md-8 col-12",children:(0,L.jsx)(k.Z,{name:"attachements",label:(0,i.ag)("entities.membership.fields.attachements"),required:!1,storage:N.Z.values.membershipAttachements,max:void 0,formats:void 0})}),(0,L.jsx)("div",{className:"col-lg-7 col-md-8 col-12",style:{display:e.userId?"none":"block"},children:(0,L.jsx)(y.Z,{name:"user",label:(0,i.ag)("entities.membership.fields.member"),required:!1,showCreate:!e.modal})}),(0,L.jsx)("div",{className:"col-lg-7 col-md-8 col-12",style:{display:e.campaignId?"none":"block"},children:(0,L.jsx)(G,{name:"campaign",label:(0,i.ag)("entities.membership.fields.campaign"),required:!1,showCreate:!e.modal})}),(0,L.jsx)("div",{className:"col-lg-7 col-md-8 col-12",children:(0,L.jsx)(j.Z,{name:"amount",label:(0,i.ag)("entities.membership.fields.amount"),required:!1})})]}),(0,L.jsxs)("div",{className:"form-buttons",children:[(0,L.jsxs)("button",{className:"btn btn-primary",disabled:e.saveLoading,type:"button",onClick:s.handleSubmit(o),children:[(0,L.jsx)(b.Z,{loading:e.saveLoading,iconClass:"far fa-save"}),(0,i.ag)("common.save")]}),(0,L.jsxs)("button",{className:"btn btn-light",type:"button",disabled:e.saveLoading,onClick:function(){Object.keys(t).forEach((function(e){s.setValue(e,t[e])}))},children:[(0,L.jsx)("i",{className:"fas fa-undo"}),(0,i.ag)("common.reset")]}),e.onCancel?(0,L.jsxs)("button",{className:"btn btn-light",type:"button",disabled:e.saveLoading,onClick:function(){return e.onCancel()},children:[(0,L.jsx)("i",{className:"fas fa-times"}),(0,i.ag)("common.cancel")]}):null]})]})}))})},Y=t(27829),_=t(53852),X=t(61567),W=t(75352);var H=function(e){var n=(0,a.useState)(!1),t=(0,r.Z)(n,2),c=t[0],u=t[1],d=(0,s.I0)(),h=(0,o.$B)(),p=(0,s.v9)(m.selectInitLoading),v=(0,s.v9)(m.selectSaveLoading),b=(0,s.v9)(m.selectRecord),g=Boolean(h.params.id),x=g?(0,i.ag)("entities.membership.edit.title"):(0,i.ag)("entities.membership.new.title");return(0,a.useEffect)((function(){d(l.Z.doInit(h.params.id)),u(!0)}),[d,h.params.id]),(0,L.jsxs)(L.Fragment,{children:[(0,L.jsx)(_.Z,{items:[[(0,i.ag)("dashboard.menu"),"/"],[(0,i.ag)("entities.membership.menu"),"/membership"],[x]]}),(0,L.jsxs)(Y.Z,{children:[(0,L.jsx)(W.Z,{children:x}),p&&(0,L.jsx)(X.Z,{}),c&&!p&&(0,L.jsx)(K,{userId:e.location.id,campaignId:e.location.campaign,formuleId:e.location.formule,saveLoading:v,initLoading:p,record:b,isEditing:g,onSubmit:function(n,t){e.location.id&&(t.user=e.location.id),e.location.campaign&&(t.campaign=e.location.campaign),e.location.formule&&(t.formule=e.location.formule),d(g?l.Z.doUpdate(n,t):l.Z.doCreate(t))},onCancel:function(){return(0,f.s1)().goBack()}})]})]})}},87347:function(e,n,t){"use strict";var r=t(47313),a=t(10619),s=t(43270),o=t(49384),i=t(46417);function l(e){var n=e.label,t=e.name,l=e.hint,c=e.storage,u=e.formats,d=e.max,m=e.required,f=e.externalErrorMessage,h=(0,s.Gc)(),p=h.register,v=h.errors,b=h.formState,g=b.touched,x=b.isSubmitted,Z=h.setValue,j=h.watch;(0,r.useEffect)((function(){p({name:t})}),[p,t]);var y=o.Z.errorMessage(t,v,g,x,f);return(0,i.jsxs)("div",{className:"form-group",children:[Boolean(n)&&(0,i.jsx)("label",{className:"col-form-label ".concat(m?"required":null),htmlFor:t,children:n}),(0,i.jsx)("br",{}),(0,i.jsx)(a.Z,{storage:c,formats:u,value:j(t),onChange:function(n){Z(t,n,{shouldValidate:!0,shouldDirty:!0}),e.onChange&&e.onChange(n)},max:d}),(0,i.jsx)("div",{className:"invalid-feedback",children:y}),Boolean(l)&&(0,i.jsx)("small",{className:"form-text text-muted",children:l})]})}l.defaultProps={max:void 0,required:!1},n.Z=l},30513:function(e,n,t){"use strict";t(47313);var r=t(43270),a=t(49384),s=t(46417);function o(e){var n=e.label,t=e.name,o=e.hint,i=e.size,l=e.placeholder,c=e.autoFocus,u=e.autoComplete,d=e.externalErrorMessage,m=e.required,f={small:"col-form-label-sm",large:"col-form-label-lg"}[i]||"",h={small:"form-control-sm",large:"form-control-lg"}[i]||"",p=(0,r.Gc)(),v=p.register,b=p.errors,g=p.formState,x=g.touched,Z=g.isSubmitted,j=a.Z.errorMessage(t,b,x,Z,d);return(0,s.jsxs)("div",{className:"form-group",children:[Boolean(n)&&(0,s.jsx)("label",{className:"col-form-label ".concat(m?"required":null," ").concat(f),htmlFor:t,children:n}),(0,s.jsx)("textarea",{id:t,name:t,ref:v,onChange:function(n){e.onChange&&e.onChange(n.target.value)},onBlur:function(n){e.onBlur&&e.onBlur(n)},placeholder:l||void 0,autoFocus:c||void 0,autoComplete:u||void 0,className:"form-control ".concat(h," ").concat(j?"is-invalid":"")}),(0,s.jsx)("div",{className:"invalid-feedback",children:j}),Boolean(o)&&(0,s.jsx)("small",{className:"form-text text-muted",children:o})]})}o.defaultProps={required:!1},n.Z=o},10619:function(e,n,t){"use strict";var r=t(42982),a=t(15861),s=t(70885),o=t(87757),i=t.n(o),l=t(47313),c=t(6891),u=t(33512),d=t(10499),m=t(95748),f=t(46417);n.Z=function(e){var n=(0,l.useState)(!1),t=(0,s.Z)(n,2),o=t[0],h=t[1],p=(0,l.useRef)(),v=function(){var n=e.value;return n?Array.isArray(n)?n:[n]:[]},b=function(){var n=(0,a.Z)(i().mark((function n(t){var a,s;return i().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(n.prev=0,(a=t.target.files)&&a.length){n.next=4;break}return n.abrupt("return");case 4:return s=a[0],c.Z.validate(s,{storage:e.storage,formats:e.formats}),h(!0),n.next=9,c.Z.upload(s,{storage:e.storage,formats:e.formats});case 9:s=n.sent,p.current.value="",h(!1),e.onChange([].concat((0,r.Z)(v()),[s])),n.next=21;break;case 15:n.prev=15,n.t0=n.catch(0),p.current.value="",console.error(n.t0),h(!1),u.Z.showMessage(n.t0);case 21:case"end":return n.stop()}}),n,null,[[0,15]])})));return function(e){return n.apply(this,arguments)}}(),g=e.max,x=e.readonly,Z=(0,f.jsxs)("label",{className:"btn btn-outline-secondary px-4 mb-2",style:{cursor:"pointer"},children:[(0,f.jsx)(m.Z,{loading:o,iconClass:"fas fa-plus"}),(0,d.ag)("fileUploader.upload"),(0,f.jsx)("input",{style:{display:"none"},disabled:o||x,accept:function(){var n=e.schema;if(n&&n.formats)return n.formats.map((function(e){return".".concat(e)})).join(",")}(),type:"file",onChange:b,ref:p})]});return(0,f.jsxs)("div",{children:[x||g&&v().map((function(e){return{uid:e.id||void 0,name:e.name,status:"done",url:e.downloadUrl}})).length>=g?null:Z,v()&&v().length?(0,f.jsx)("div",{children:v().map((function(n){return(0,f.jsxs)("div",{children:[(0,f.jsx)("i",{className:"fas fa-link text-muted mr-2"}),(0,f.jsx)("a",{href:n.downloadUrl,target:"_blank",rel:"noopener noreferrer",download:!0,children:n.name}),!x&&(0,f.jsx)("button",{className:"btn btn-link",type:"button",onClick:function(){return t=n.id,void e.onChange(v().filter((function(e){return e.id!==t})));var t},children:(0,f.jsx)("i",{className:"fas fa-times"})})]},n.id)}))}):null]})}},48317:function(e,n,t){"use strict";var r=t(1413),a=t(42982),s=t(70885),o=t(47313),i=t(74773),l=t(70713),c=t(49513),u=t(43270),d=t(45788),m=t(15021),f=t(46417);n.Z=function(e){var n=(0,u.Gc)(),t=n.setValue,h=n.getValues,p=(0,o.useState)(!1),v=(0,s.Z)(p,2),b=v[0],g=v[1],x=(0,d.v9)(m.Z.selectPermissionToCreate);return(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)(c.Z,(0,r.Z)((0,r.Z)({},e),{},{fetchFn:function(e,n){return i.Z.fetchUserAutocomplete(e,n)},mapper:{toAutocomplete:function(e){if(!e)return null;if(e.fullName||e.email){var n=e.email;return e.fullName&&(n="".concat(e.fullName," <").concat(e.email,">")),{value:e.id,label:n}}return{value:e.id,label:e.label}},toValue:function(e){return e?{id:e.value,label:e.label}:null}},onOpenModal:function(){return g(!0)},hasPermissionToCreate:x})),b&&(0,f.jsx)(l.Z,{visible:b,onClose:function(){return g(!1)},onSuccess:function(n){var r=e.name,s=e.mode;t(r,s&&"multiple"===s?[].concat((0,a.Z)(h()[r]||[]),[n]):n),g(!1)}})]})}},99811:function(e,n,t){"use strict";!function(n){var t=/^(b|B)$/,r={iec:{bits:["b","Kib","Mib","Gib","Tib","Pib","Eib","Zib","Yib"],bytes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"]},jedec:{bits:["b","Kb","Mb","Gb","Tb","Pb","Eb","Zb","Yb"],bytes:["B","KB","MB","GB","TB","PB","EB","ZB","YB"]}},a={iec:["","kibi","mebi","gibi","tebi","pebi","exbi","zebi","yobi"],jedec:["","kilo","mega","giga","tera","peta","exa","zetta","yotta"]};function s(e){var n,s,o,i,l,c,u,d,m,f,h,p,v,b,g,x=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},Z=[],j=0,y=void 0,w=void 0;if(isNaN(e))throw new TypeError("Invalid number");return s=!0===x.bits,h=!0===x.unix,n=x.base||2,f=void 0!==x.round?x.round:h?1:2,c=void 0!==x.locale?x.locale:"",u=x.localeOptions||{},p=void 0!==x.separator?x.separator:"",v=void 0!==x.spacer?x.spacer:h?"":" ",g=x.symbols||{},b=2===n&&x.standard||"jedec",m=x.output||"string",i=!0===x.fullform,l=x.fullforms instanceof Array?x.fullforms:[],y=void 0!==x.exponent?x.exponent:-1,o=2<n?1e3:1024,(d=(w=Number(e))<0)&&(w=-w),(-1===y||isNaN(y))&&(y=Math.floor(Math.log(w)/Math.log(o)))<0&&(y=0),8<y&&(y=8),"exponent"===m?y:(0===w?(Z[0]=0,Z[1]=h?"":r[b][s?"bits":"bytes"][y]):(j=w/(2===n?Math.pow(2,10*y):Math.pow(1e3,y)),s&&o<=(j*=8)&&y<8&&(j/=o,y++),Z[0]=Number(j.toFixed(0<y?f:0)),Z[0]===o&&y<8&&void 0===x.exponent&&(Z[0]=1,y++),Z[1]=10===n&&1===y?s?"kb":"kB":r[b][s?"bits":"bytes"][y],h&&(Z[1]="jedec"===b?Z[1].charAt(0):0<y?Z[1].replace(/B$/,""):Z[1],t.test(Z[1])&&(Z[0]=Math.floor(Z[0]),Z[1]=""))),d&&(Z[0]=-Z[0]),Z[1]=g[Z[1]]||Z[1],!0===c?Z[0]=Z[0].toLocaleString():0<c.length?Z[0]=Z[0].toLocaleString(c,u):0<p.length&&(Z[0]=Z[0].toString().replace(".",p)),"array"===m?Z:(i&&(Z[1]=l[y]?l[y]:a[b][y]+(s?"bit":"byte")+(1===Z[0]?"":"s")),"object"===m?{value:Z[0],symbol:Z[1],exponent:y}:Z.join(v)))}s.partial=function(e){return function(n){return s(n,e)}},e.exports=s}("undefined"!=typeof window?window:t.g)},34405:function(e,n,t){var r=t(99038);e.exports=function(e,n){return!!(null==e?0:e.length)&&r(e,n,0)>-1}},86722:function(e){e.exports=function(e,n,t){for(var r=-1,a=null==e?0:e.length;++r<a;)if(t(n,e[r]))return!0;return!1}},93527:function(e){e.exports=function(e,n,t,r){for(var a=e.length,s=t+(r?1:-1);r?s--:++s<a;)if(n(e[s],s,e))return s;return-1}},99038:function(e,n,t){var r=t(93527),a=t(57700),s=t(13245);e.exports=function(e,n,t){return n===n?s(e,n,t):r(e,a,t)}},57700:function(e){e.exports=function(e){return e!==e}},7579:function(e,n,t){var r=t(44526),a=t(34405),s=t(86722),o=t(88905),i=t(56946),l=t(73671);e.exports=function(e,n,t){var c=-1,u=a,d=e.length,m=!0,f=[],h=f;if(t)m=!1,u=s;else if(d>=200){var p=n?null:i(e);if(p)return l(p);m=!1,u=o,h=new r}else h=n?[]:f;e:for(;++c<d;){var v=e[c],b=n?n(v):v;if(v=t||0!==v?v:0,m&&b===b){for(var g=h.length;g--;)if(h[g]===b)continue e;n&&h.push(b),f.push(v)}else u(h,b,t)||(h!==f&&h.push(b),f.push(v))}return f}},56946:function(e,n,t){var r=t(4199),a=t(8568),s=t(73671),o=r&&1/s(new r([,-0]))[1]==1/0?function(e){return new r(e)}:a;e.exports=o},13245:function(e){e.exports=function(e,n,t){for(var r=t-1,a=e.length;++r<a;)if(e[r]===n)return r;return-1}},8568:function(e){e.exports=function(){}},35487:function(e,n,t){var r=t(81186),a=t(7579);e.exports=function(e,n){return e&&e.length?a(e,r(n,2)):[]}}}]);